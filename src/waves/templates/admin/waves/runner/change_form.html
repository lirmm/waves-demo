{% extends "admin/change_form.html" %}
{% load i18n admin_modify admin_urls admin_static waves_tags %}
{% block content %}
    {% if is_popup %}
        <script language="JavaScript">
            window.onunload = refreshParent;
            function refreshParent() {
                window.opener.$("input[type='submit'][name='_continue']").trigger('click');
            }
        </script>
    {% endif %}
    {{ block.super }}
{% endblock %}
{% block modal_content %}
    <div id="connect_result"
         class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">

            </div>
        </div>
    </div>
{% endblock %}
{% block object-tools-items %}
    <li>
        <a href="{% url 'admin:waves_service_changelist' %}?run_on__id__exact={{ original.pk }}"
           class="link">{% trans "Associated Services" %}</a>
    </li>
    {{ block.super }}
    <li>
        <a type="button" href="{% url 'waves:runner_export_form' original.pk %}"
           title="View online"
           class="btn btn-high btn-info"
           id="view_jobs">
            Export
        </a>
    </li>
    {% if original.clazz %}
        <li>
            <a type="button" href="{% url 'waves:runner_test_connection' original.pk %}"
               title="Connection Test"
               class="btn btn-high btn-info"
               data-toggle="modal"
               data-target="#form-modal"
               id="test_connect">
                Test Connection
            </a>
        </li>
    {% endif %}
    {% if original.adaptor.importer_clazz %}
        <li>
            <a type="button" href="{% url 'waves:runner_import_form' original.pk %}"
               target="_blank"
               title="Import from adapter"
               class="js-popup-link btn btn-high btn-info"
               data-toggle="modal"
               data-target="#connect_result"
               id="launch_import">
                Import a Service
            </a>
        </li>
    {% endif %}
{% endblock %}
